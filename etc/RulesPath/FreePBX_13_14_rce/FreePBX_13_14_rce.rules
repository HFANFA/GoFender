alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[ATTACK] FreePBX 13/14 Malicious Filename Upload attempt"; flow: to_server; content: "POST"; http_method; nocase; content:"/admin/ajax.php?"; http_uri; content:"module=recordings"; http_uri; content:"command=savebrowserrecording"; http_uri; content: "Content-Type: multipart/form-data"; nocase; http_header; pcre:"/Content-Disposition: form-data\; name=\x22filename\x22\r\n\r\n[^\r\n]*\x60[^\r\n]*\x60.*\r\n/P"; xbits: set, FreePBXMaliciousFilenameUpload, track ip_dst, expire 30; classtype: attempted-user; reference: exploitdb, 40232; reference: url, github.com/ptresearch/AttackDetection; sid:10000082; rev:2;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[ATTACK] FreePBX 13/14 Remote Command Execution"; flow: to_server; content: "POST"; http_method; nocase; content:"/admin/ajax.php"; http_uri; content: "Content-Type: application/x-www-form-urlencoded"; nocase; http_header; pcre:"/file=[^&]*\x60[^&]*\x60/P"; pcre:"/module=recordings/P"; xbits: isset, FreePBXMaliciousFilenameUpload, track ip_dst; classtype: successful-user; reference: exploitdb, 40232; reference: url, github.com/ptresearch/AttackDetection; sid:10000083; rev:2;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"[ATTACK] FreePBX 13/14 Remote Command Execution attempt"; flow: to_server; content:"POST"; http_method; content:"/admin/ajax.php"; http_uri; content:"Content-Type: application/x-www-form-urlencoded"; nocase; http_header; pcre:"/file=[^&]*\x60[^&]*\x60/P"; pcre:"/module=recordings/P"; xbits: isnotset, FreePBXMaliciousFilenameUpload, track ip_dst; classtype: attempted-user; reference: exploitdb, 40232; reference: url, github.com/ptresearch/AttackDetection; sid:10000084; rev:2;)
