alert tls $HOME_NET any -> $EXTERNAL_NET any (msg: "[MALWARE] Dridex/Feodo-D SSL connection 0.1"; flow: established, to_server; content: "|17 03 01 00 80|"; depth:5; stream_size: server, <,1905; stream_size: client, <,9911; stream_size: client, >,0; stream_size: server, >,0; flowbits: noalert;flowbits: set, FB313831_0; classtype: trojan-activity; metadata: created_at 2017_8_1; reference: url, github.com/ptresearch/AttackDetection; sid: 10001683; rev: 1;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg: "[MALWARE] Dridex/Feodo-D SSL connection 0.2"; flow: established, to_server; content: "|17 03 01 00 90|"; depth:5; stream_size: server, <,1905; stream_size: client, <,9911; stream_size: client, >,0; stream_size: server, >,0; flowbits: noalert;flowbits: set, FB313831_0; classtype: trojan-activity; metadata: created_at 2017_8_1; reference: url, github.com/ptresearch/AttackDetection; sid: 10001684; rev: 1;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg: "[MALWARE] Dridex/Feodo-D SSL connection 1"; flow: established, to_server; content: "|1703|"; depth:2; byte_test: 2, >=,2512, 1, relative; byte_test: 2, <=,7900, 1, relative; stream_size: server, <,1905; stream_size: client, <,9911; stream_size: client, >,0; stream_size: server, >,0; flowbits: noalert; flowbits: isset, FB313831_0; flowbits: unset, FB313831_0; flowbits: set, FB313831_1; classtype: trojan-activity; metadata: created_at 2017_8_1; reference: url, github.com/ptresearch/AttackDetection; sid: 10001685; rev: 1;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Dridex/Feodo-D SSL connection 2.1"; flow: established, to_client; content: "|17 03 01 01 60|"; depth:5; stream_size: server, <,2257; stream_size: client, <,10263; stream_size: client, >,0; stream_size: server, >,0; flowbits: isset, FB313831_1; flowbits: unset, FB313831_1; threshold: type limit, track by_src, count 1, seconds 300;classtype: trojan-activity; metadata: created_at 2017_8_1; reference: url, github.com/ptresearch/AttackDetection; sid: 10001686; rev: 1;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Dridex/Feodo-D SSL connection 2.2"; flow: established, to_client; content: "|17 03 01 00 D0|"; depth:5; stream_size: server, <,2257; stream_size: client, <,10263; stream_size: client, >,0; stream_size: server, >,0; flowbits: isset, FB313831_1; flowbits: unset, FB313831_1; threshold: type limit, track by_src, count 1, seconds 300;classtype: trojan-activity; metadata: created_at 2017_8_1; reference: url, github.com/ptresearch/AttackDetection; sid: 10001792; rev: 1;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Dridex/Feodo-D SSL connection 2.3"; flow: established, to_client; content: "|17 03 01 00 C0|"; depth:5; stream_size: server, <,2257; stream_size: client, <,10263; stream_size: client, >,0; stream_size: server, >,0; flowbits: isset, FB313831_1; flowbits: unset, FB313831_1; threshold: type limit, track by_src, count 1, seconds 300;classtype: trojan-activity; metadata: created_at 2017_8_1; reference: url, github.com/ptresearch/AttackDetection; sid: 10001793; rev: 1;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Trickbot/Dyre/Dridex 1"; flow: established, to_client; content: "|1703|"; depth:2; byte_test: 2, >=,160, 1, relative; byte_test: 2, <=,240, 1, relative; stream_size: server, <,3000; stream_size: client, <,3000; flowbits: noalert; flowbits: set, FB320221_0; classtype: trojan-activity; metadata: created_at 2017_8_11; reference: url, github.com/ptresearch/AttackDetection; sid: 10001758; rev: 1;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Trickbot/Dyre/Dridex 2";flow: established, to_client;content: "|17 03 01 00 F0|";depth:5;content: "|17 03 01  00 20|";distance:240;within:5;content: "|17 03 01|";distance:32;within:3;stream_size: server, <,30000;stream_size: client, <,30000;flowbits: isset, FB320221_0; flowbits: unset, FB320221_0; flowbits: set, FB320221_1; flowbits: noalert ; classtype: trojan-activity;metadata: created_at 2017_8_11; reference: url, github.com/ptresearch/AttackDetection; sid: 10001759; rev: 2;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Trickbot/Dyre/Dridex 3";flow: established, to_client;content: "|17 03 01 01 00|"; depth:5; content: "|17 03 01  00 20|"; distance:256; within:5; content: "|17 03 01|";distance:32;within:3;stream_size: server, <,30000;stream_size: client, <,30000;flowbits: isset, FB320221_0; flowbits: unset, FB320221_0; flowbits: set, FB320221_1; classtype: trojan-activity;metadata: created_at 2017_8_11; reference: url, github.com/ptresearch/AttackDetection; sid: 10001760; rev: 1;)

 For Suricon 2018. Disabled by default.
alert tls $HOME_NET any -> $EXTERNAL_NET any (msg: "[MALWARE] Dyre/Trickbot/Dridex SSL connection 0"; flow: established, to_server; content: "|1703|"; depth:2; byte_test: 2, >=,270, 1, relative; byte_test: 2, <=,292, 1, relative; stream_size: server, <,2710; stream_size: client, <,1540; flowbits: noalert; flowbits: set, FB314917_0; classtype: trojan-activity; metadata: created_at 2017_8_3; reference: url, github.com/ptresearch/AttackDetection; sid: 11101465; rev: 2;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "[MALWARE] Dyre/Trickbot/Dridex SSL connection 1"; flow: established, to_client; content: "|1703|"; depth:2; byte_test: 2, >=,400, 1, relative; byte_test: 2, <=,416, 1, relative; stream_size: server, <,2710; stream_size: client, <,1540;  flowbits: isset, FB314917_0; flowbits: unset, FB314917_0; flowbits: set, FB314917_1;  flowbits: noalert; classtype: trojan-activity; metadata: created_at 2017_8_3; reference: url, github.com/ptresearch/AttackDetection; sid: 11101466; rev: 2;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg: "[MALWARE] Dyre/Trickbot/Dridex SSL connection 2"; flow: established, to_server; content: "|1703|"; depth:2; byte_test: 2, >=,400, 1, relative;  byte_test: 2, <=,416, 1, relative; stream_size: server, <,3300; stream_size: client, <,2500;  flowbits: isset, FB314917_1; flowbits: unset, FB314917_1; flowbits: set, FB314917_2; classtype: trojan-activity; metadata: created_at 2017_8_3; reference: url, github.com/ptresearch/AttackDetection; sid: 11101467; rev: 1;)
