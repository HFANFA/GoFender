alert smb any any -> any any (msg: "[ATTACK] AD SPOOLSS DCERPC/SMB Bind"; flow: to_server, established, no_stream; content:"SMB"; offset: 5; depth: 3; content: "|05 00 0B|"; distance: 0; content: "|78 56 34 12 34 12 cd ab ef 00 01 23 45 67 89 ab 01 00 00 00|"; distance: 29; flowbits: set, DCERPC.BIND.SPOOLSS; flowbits: noalert; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-recon; sid: 10004152; rev: 1; )

alert smb any any -> $DC_SERVERS 445 (msg: "[ATTACK] AD Possible MS-RPRN abuse. Hash or Ticket theft"; flow: to_server, established, no_stream; content:"SMB"; offset: 5; depth: 3; content: "|05 00 00|"; distance: 0; content: "|41 00|"; distance: 19; within: 2; content: "|00 01 00 00|"; distance: 36; within: 4; content: "|5C 00 5C 00|"; fast_pattern; distance: 0; flowbits: isset, DCERPC.BIND.SPOOLSS; reference: url, posts.specterops.io/not-a-security-boundary-breaking-forest-trusts-cd125829518d; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-recon; sid: 10004153; rev: 1;)
