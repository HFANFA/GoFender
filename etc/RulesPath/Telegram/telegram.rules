 MTproto Telegram
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg: "APP MTproto Telegram pkt chk0"; flow: established, to_server; dsize: 130<>240; content: !"|1603|"; depth: 2; stream_size: server, =, 1;  stream_size: server, =, 1; stream_size: client, >,130; stream_size: client, <,300; flowbits: set, FBMproto_0; flowbits: noalert; pcre: "/[\x09-\x0e]/"; reference: url, github.com/ptresearch/AttackDetection; metadata: autosign, id_0,;  metadata: created_at 2019_02_19, updated_at 2021_03_20; classtype: misc-activity; sid: 11004534; rev: 4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "APP MTproto Telegram pkt chk1"; flow: established, to_client; dsize: 100<>120; stream_size: server, >,100; stream_size: server, <,200; stream_size: client, >,130; stream_size: client, <,300; flowbits: isset, FBMproto_0; flowbits: unset, FBMproto_0; flowbits: set, FBMproto_1; flowbits: noalert; pcre: "/[\x09-\x0e]/"; reference: url, github.com/ptresearch/AttackDetection; metadata: autosign, id_0,;  metadata: created_at 2019_02_19, updated_at 2021_03_20; classtype: misc-activity; sid: 11004535; rev: 3;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg: "APP MTproto Telegram pkt chk2"; flow: established, to_server; dsize: 130<>450; stream_size: server, >,100; stream_size: server, <,200; stream_size: client, >,260; stream_size: client, <,880; flowbits: isset, FBMproto_1; flowbits: unset, FBMproto_1; flowbits: set, FBMproto_2; flowbits: noalert; pcre: "/[\x09-\x0e]/"; reference: url, github.com/ptresearch/AttackDetection; metadata: autosign, id_0,;  metadata: created_at 2019_02_19, updated_at 2021_03_20; classtype: misc-activity; sid: 11004536; rev: 3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "APP MTproto Telegram pkt chk3"; flow: established, to_client; dsize: 150<>250; stream_size: server, >,250; stream_size: server, <,600; stream_size: client, >,260; stream_size: client, <,880; flowbits: isset, FBMproto_2; flowbits: unset, FBMproto_2; flowbits: set, FBMproto_3; flowbits: noalert; pcre: "/[\x09-\x0e]/"; reference: url, github.com/ptresearch/AttackDetection; metadata: autosign, id_0,;  metadata: created_at 2019_02_19, updated_at 2021_03_20; classtype: misc-activity; sid: 11004537; rev: 3;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg: "APP MTproto Telegram"; flow: established, to_server; dsize: 250<>350;stream_size: server, >,250;stream_size: server, <,600;stream_size: client, >,460;stream_size: client, <,1000;flowbits: isset, FBMproto_3;flowbits: unset, FBMproto_3; pcre: "/[\x09-\x0e]/"; reference: url, github.com/ptresearch/AttackDetection; metadata: autosign, id_0,; metadata: created_at 2019_02_19, updated_at 2019_07_25; classtype: misc-activity; sid: 11004538; rev: 2;)

