alert http any any -> any any (msg: "[ATTACK] Mikrotik Router OS 6.38.4 Stack Clash RCE"; flow: established, to_server; content: "POST"; http_method; content: "/jsproxy"; http_uri; fast_pattern; content: "Content-Length: "; http_header; content: !"|0D|"; within: 5; http_header; xbits: set, RouterOS.StackClash.POST2, track ip_src, expire 10; flowbits: noalert; reference: url, github.com/BigNerd95/Chimay-Red/blob/master/StackClashMIPS.py; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002456; rev: 1; )

alert tcp any any -> any any (msg: "[ATTACK] Mikrotik Router OS 6.38.4 Stack Clash RCE"; flow: established, to_server, no_stream; content: "|24 50 00 00 26 04 00 40 AE 04 FF F0 26 11 00 50 AE 11 FF F4 26 11 00 60 AE 11 FF F8 22 05 FF F0 22 06 FF FC 24 02 0F AB 00 00 00 0C|"; content: "/bin"; within: 30; xbits: isset, RouterOS.StackClash.POST2, track ip_src; reference: url, github.com/BigNerd95/Chimay-Red/blob/master/StackClashMIPS.py; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002457; rev: 1; )

alert http any any -> any any (msg: "[ATTACK] Possible Mikrotik Router OS 6.38.4 Stack Clash RCE"; flow: established, to_server; content: "POST"; http_method; content: "/jsproxy"; http_uri; fast_pattern; content: "Content-Length: "; http_header; content: !"|0D|"; within: 6; http_header; byte_test: 0, =, 167936, 0, relative, string; threshold: type both, track by_src, count 2, seconds 5; reference: url, github.com/BigNerd95/Chimay-Red/blob/master/StackClashMIPS.py; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002459; rev: 2; )

