alert tcp-pkt any any -> any any (msg: "[ATTACK] EFSR Bind"; flow: established, to_server; content: "|05 00 0B|"; content: "|88 D4 81 C6 50 D8 D0 11 8C 52 00 C0 4F D9 0F 7E|"; within: 64; flowbits: set, DCERPC.EFSR.Bind; reference: url, github.com/ptresearch/AttackDetection; metadata: Open Ptsecurity.com ruleset;  metadata: created_at 2021_07_23, updated_at 2021_11_19; classtype: attempted-admin; sid: 10006662; rev: 2;)

alert tcp-pkt any any -> any any (msg: "[ATTACK] EFSR /efsrpc Bind"; flow: established, to_server; content: "|05 00 0B|"; content: "|C5 41 19 DF 89 FE 79 4E BF 10 46 36 57 AC F4 4D|"; within: 64; flowbits: set, DCERPC.EFSR.Bind; reference: url, github.com/ptresearch/AttackDetection; metadata: Open Ptsecurity.com ruleset;  metadata: created_at 2021_07_23, updated_at 2021_11_19; classtype: attempted-admin; sid: 10006663; rev: 2;)

alert dcerpc any any -> any any (msg: "[ATTACK] PetitPotam (Machine account NTLM Hash leak) attempt"; flow: established, to_server; content: "|05 00 00|"; depth: 70; content: "|00 00|"; distance: 19; within: 2; flowbits: isset, DCERPC.EFSR.Bind; xbits: set, PetitPotam.Attempt, track ip_dst, expire 10; reference: url, github.com/ptresearch/AttackDetection; reference: url, github.com/topotam/PetitPotam; metadata: Open Ptsecurity.com ruleset;  metadata: created_at 2021_07_23, updated_at 2021_11_19; classtype: attempted-admin; sid: 10006664; rev: 3;)

alert tcp any any -> any any (msg: "[ATTACK] PetitPotam (Machine account NTLM Hash leak) successful"; flow: established, to_server; content: "SMB"; content: "NTLMSSP|00 03 00 00 00|"; distance: 0; byte_jump: 4, 36, relative, little, post_offset -55; content: "|00 24 00|"; within: 3; xbits: isset, PetitPotam.Attempt, track ip_src; reference: url, github.com/ptresearch/AttackDetection; reference: url, github.com/topotam/PetitPotam; metadata: Open Ptsecurity.com ruleset; metadata: created_at 2021_07_23, updated_at 2021_07_23; classtype: attempted-admin; sid: 10006665; rev: 2;)

