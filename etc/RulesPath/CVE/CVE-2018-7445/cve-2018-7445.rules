alert tcp any any -> $HOME_NET 139 (msg: "[ATTACK] Mikrotik <6.41.3 <6.42rc27 RCE Attempt (CVE-2018-7445)"; flow: established, to_server, no_stream; content: "|81 00|"; depth: 2; byte_test: 1, >, 0x20, 2, relative; content: "|00 00 00|"; distance: 0; reference: cve, 2018-7445; reference: url, www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002680; rev: 1; )

alert tcp any any -> $HOME_NET 139 (msg: "[ATTACK] ShellCode Upload Mikrotik <6.41.3 <6.42rc27 RCE (CVE-2018-7445)"; flow: established, to_server, only_stream; content: "|00 00 eb 02 00 00 eb 02|"; depth: 8; pcre: "/(?:\x00\x00\xeb\x02){10}/R"; reference: cve, 2018-7445; reference: url, www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002681; rev: 1; )

alert tcp $HOME_NET 139 -> any any (msg: "[ATTACK] Successful Mikrotik <6.41.3 <6.42rc27 RCE (CVE-2018-7445)"; flow: established, from_server, no_stream; content: "sh: "; depth: 4; reference: cve, 2018-7445; reference: url, www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow; classtype: successful-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002682; rev: 1; )

